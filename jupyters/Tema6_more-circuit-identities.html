

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>14. Más ciruitos cuánticos &#8212; Programación Cuántica</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'jupyters/Tema6_more-circuit-identities';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="15. Proving Universality" href="Tema7_proving-universality.html" />
    <link rel="prev" title="12. Explorando la puerta CNOT-Gate" href="Tema5_phase-kickback.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../introduccion.html">
  
  
  
  
  
    <p class="title logo__title">Programación Cuántica</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../introduccion.html">
                    Introducción
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Base teórica de la programación cuántica</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ParteTeorica_I.html">1. Los qubits en la programación cuántica</a></li>
<li class="toctree-l1"><a class="reference internal" href="numeros_complejos.html">2. Introducción a los números complejos</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParteTeorica_II.html">3. Otros aspectos de los qubits</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParteTeorica_III_puertasCuanticas.html">4. Puertas cuánticas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parte_teorica_IV_algebra.html">5. Álgebra lineal</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parte_teorica_V_qubitMultiple.html">6. Múltiples qubits</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Estados quanticos y qubits</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Tema0_Introducci%C3%B3n.html">7. Introducción a programación cuántica</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tema1_atoms-computation.html">8. Los qubits</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tema2_representing-qubit-states.html">9. Representación de los estados del qubit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tema3_single-qubit-gates.html">10. Puertas cuánticas para un qubit</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Qubits múltiples y Entanglement</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Tema4_multiple-qubits-entangled-states.html">11. Múltiples qubits</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tema5_phase-kickback.html">12. Explorando la puerta CNOT-Gate <a id="exploring-cnot"></a></a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">14. Otros circuitos</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tema7_proving-universality.html">15. Universalidad</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Algoritmos cuánticos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="algoritmos/deutsch_Jozsa.html">16. Algoritmo Deutsch_Jozsa</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Índice de términos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">17. Índice de términos</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Apéndice</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="otras/anexo1_Algebralineal.html">Resumen Algebra lineal</a></li>
<li class="toctree-l1"><a class="reference internal" href="anexo_simpy.html">Matemática simbólica</a></li>
<li class="toctree-l1"><a class="reference internal" href="paquetequtip.html">Paquete Qutib: Representación esfera Bloch</a></li>
<li class="toctree-l1"><a class="reference internal" href="videos_anexo.html">Vídeos</a></li>
<li class="toctree-l1"><a class="reference internal" href="otras/apendice.html">Apendice.</a></li>




</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/jupyters/Tema6_more-circuit-identities.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Más ciruitos cuánticos</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construyendo-una-z-controlada-desde-un-cnot-a-id-c-from-cnot-a">14.1. Construyendo una Z controlada desde un CNOT. <a id="c-from-cnot"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intercambio-de-qubits-a-id-swapping-a">14.2. Intercambio de Qubits <a id="swapping"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-ejercicios">14.2.1. Quick Ejercicios:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotaciones-controladas-a-id-controlled-rotations-a">14.3. Rotaciones controladas <a id="controlled-rotations"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#la-puerta-de-toffoli-a-id-ccx-a">14.4. La puerta de Toffoli <a id="ccx"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotacion-arbitraria-de-h-y-t-a-id-arbitrary-rotations-a">14.5. Rotación arbitraria de H y T. <a id="arbitrary-rotations"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#referencias-a-id-references-a">14.6. Referencias <a id="references"></a></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="mas-ciruitos-cuanticos">
<h1><span class="section-number">14. </span>Más ciruitos cuánticos<a class="headerlink" href="#mas-ciruitos-cuanticos" title="Permalink to this heading">#</a></h1>
<p>Cuando programamos ordenadores cuánticos, nuestro objetivo es siempre construir circuitos cuánticos útiles a partir de los bloques de construcción básicos. Pero a veces, puede que no tengamos todos los bloques de construcción básicos que queremos. En esta sección, veremos cómo podemos transformar puertas básicas entre sí, y cómo utilizarlas para construir algunas puertas que son un poco más complejas (pero todavía bastante básicas).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">QuantumCircuit</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit</span> <span class="kn">import</span> <span class="n">Gate</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># sería el qubit de control</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># el qubit de target</span>
</pre></div>
</div>
</div>
</div>
<section id="construyendo-una-z-controlada-desde-un-cnot-a-id-c-from-cnot-a">
<h2><span class="section-number">14.1. </span>Construyendo una Z controlada desde un CNOT. <a id="c-from-cnot"></a><a class="headerlink" href="#construyendo-una-z-controlada-desde-un-cnot-a-id-c-from-cnot-a" title="Permalink to this heading">#</a></h2>
<p>La <a class="reference internal" href="Tema3_single-qubit-gates.html#zcontrolada"><span class="std std-ref">puerta Z controlada</span></a> o <code class="docutils literal notranslate"><span class="pre">cz</span></code> (así se denomina en qiskit) es otra puerta de dos qubits muy utilizada. Al igual que la CNOT aplica una <span class="math notranslate nohighlight">\(X\)</span> a su qubit de destino siempre que su control esté en estado <span class="math notranslate nohighlight">\(|1\rangle\)</span>, la puerta controlada-<span class="math notranslate nohighlight">\(Z\)</span> aplica una <span class="math notranslate nohighlight">\(Z\)</span> en el mismo caso. En Qiskit se puede invocar directamente con el siguiente código:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># a controlled-Z</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">MissingOptionalLibraryError</span><span class="g g-Whitespace">               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># a controlled-Z</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">qc</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>

<span class="nn">File D:\programas\Anaconda\Lib\site-packages\qiskit\circuit\quantumcircuit.py:1913,</span> in <span class="ni">QuantumCircuit.draw</span><span class="nt">(self, output, scale, filename, style, interactive, plot_barriers, reverse_bits, justify, vertical_compression, idle_wires, with_layout, fold, ax, initial_state, cregbundle, wire_order)</span>
<span class="g g-Whitespace">   </span><span class="mi">1910</span> <span class="c1"># pylint: disable=cyclic-import</span>
<span class="g g-Whitespace">   </span><span class="mi">1911</span> <span class="kn">from</span> <span class="nn">qiskit.visualization</span> <span class="kn">import</span> <span class="n">circuit_drawer</span>
<span class="ne">-&gt; </span><span class="mi">1913</span> <span class="k">return</span> <span class="n">circuit_drawer</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1914</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1915</span>     <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1916</span>     <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1917</span>     <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1918</span>     <span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1919</span>     <span class="n">interactive</span><span class="o">=</span><span class="n">interactive</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1920</span>     <span class="n">plot_barriers</span><span class="o">=</span><span class="n">plot_barriers</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1921</span>     <span class="n">reverse_bits</span><span class="o">=</span><span class="n">reverse_bits</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1922</span>     <span class="n">justify</span><span class="o">=</span><span class="n">justify</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1923</span>     <span class="n">vertical_compression</span><span class="o">=</span><span class="n">vertical_compression</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1924</span>     <span class="n">idle_wires</span><span class="o">=</span><span class="n">idle_wires</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1925</span>     <span class="n">with_layout</span><span class="o">=</span><span class="n">with_layout</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1926</span>     <span class="n">fold</span><span class="o">=</span><span class="n">fold</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1927</span>     <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1928</span>     <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1929</span>     <span class="n">cregbundle</span><span class="o">=</span><span class="n">cregbundle</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1930</span>     <span class="n">wire_order</span><span class="o">=</span><span class="n">wire_order</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1931</span> <span class="p">)</span>

<span class="nn">File D:\programas\Anaconda\Lib\site-packages\qiskit\visualization\circuit\circuit_visualization.py:292,</span> in <span class="ni">circuit_drawer</span><span class="nt">(circuit, scale, filename, style, output, interactive, plot_barriers, reverse_bits, justify, vertical_compression, idle_wires, with_layout, fold, ax, initial_state, cregbundle, wire_order)</span>
<span class="g g-Whitespace">    </span><span class="mi">277</span>     <span class="k">return</span> <span class="n">_generate_latex_source</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">278</span>         <span class="n">circuit</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">279</span>         <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">289</span>         <span class="n">wire_order</span><span class="o">=</span><span class="n">complete_wire_order</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">290</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span> <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s2">&quot;mpl&quot;</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">292</span>     <span class="n">image</span> <span class="o">=</span> <span class="n">_matplotlib_circuit_drawer</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">293</span>         <span class="n">circuit</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">294</span>         <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">295</span>         <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">296</span>         <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">297</span>         <span class="n">plot_barriers</span><span class="o">=</span><span class="n">plot_barriers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">298</span>         <span class="n">reverse_bits</span><span class="o">=</span><span class="n">reverse_bits</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">299</span>         <span class="n">justify</span><span class="o">=</span><span class="n">justify</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">300</span>         <span class="n">idle_wires</span><span class="o">=</span><span class="n">idle_wires</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span>         <span class="n">with_layout</span><span class="o">=</span><span class="n">with_layout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span>         <span class="n">fold</span><span class="o">=</span><span class="n">fold</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">303</span>         <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">304</span>         <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">305</span>         <span class="n">cregbundle</span><span class="o">=</span><span class="n">cregbundle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">306</span>         <span class="n">wire_order</span><span class="o">=</span><span class="n">complete_wire_order</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">307</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">308</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span>     <span class="k">raise</span> <span class="n">VisualizationError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span>         <span class="s2">&quot;Invalid output type </span><span class="si">%s</span><span class="s2"> selected. The only valid choices &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span>         <span class="s2">&quot;are text, latex, latex_source, and mpl&quot;</span> <span class="o">%</span> <span class="n">output</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span>     <span class="p">)</span>

<span class="nn">File D:\programas\Anaconda\Lib\site-packages\qiskit\visualization\circuit\circuit_visualization.py:662,</span> in <span class="ni">_matplotlib_circuit_drawer</span><span class="nt">(circuit, scale, filename, style, plot_barriers, reverse_bits, justify, idle_wires, with_layout, fold, ax, initial_state, cregbundle, wire_order)</span>
<span class="g g-Whitespace">    </span><span class="mi">659</span> <span class="k">if</span> <span class="n">fold</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">660</span>     <span class="n">fold</span> <span class="o">=</span> <span class="mi">25</span>
<span class="ne">--&gt; </span><span class="mi">662</span> <span class="n">qcd</span> <span class="o">=</span> <span class="n">_matplotlib</span><span class="o">.</span><span class="n">MatplotlibDrawer</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">663</span>     <span class="n">qubits</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">664</span>     <span class="n">clbits</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">665</span>     <span class="n">nodes</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">666</span>     <span class="n">circuit</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">667</span>     <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">668</span>     <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">669</span>     <span class="n">reverse_bits</span><span class="o">=</span><span class="n">reverse_bits</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">670</span>     <span class="n">plot_barriers</span><span class="o">=</span><span class="n">plot_barriers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">671</span>     <span class="n">fold</span><span class="o">=</span><span class="n">fold</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">672</span>     <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">673</span>     <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">674</span>     <span class="n">cregbundle</span><span class="o">=</span><span class="n">cregbundle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">675</span>     <span class="n">with_layout</span><span class="o">=</span><span class="n">with_layout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">676</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">677</span> <span class="k">return</span> <span class="n">qcd</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

<span class="nn">File D:\programas\Anaconda\Lib\site-packages\qiskit\utils\classtools.py:111,</span> in <span class="ni">_WrappedMethod.__get__.&lt;locals&gt;.out</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span> <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span> <span class="k">def</span> <span class="nf">out</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span>     <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_before</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">111</span>         <span class="n">callback</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">objtype</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span>     <span class="n">retval</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>     <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after</span><span class="p">:</span>

<span class="nn">File D:\programas\Anaconda\Lib\site-packages\qiskit\utils\lazy_tester.py:39,</span> in <span class="ni">_RequireNow.__call__</span><span class="nt">(self, *_args, **_kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">39</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_tester</span><span class="o">.</span><span class="n">require_now</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_feature</span><span class="p">)</span>

<span class="nn">File D:\programas\Anaconda\Lib\site-packages\qiskit\utils\lazy_tester.py:223,</span> in <span class="ni">LazyDependencyManager.require_now</span><span class="nt">(self, feature)</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span> <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="k">return</span>
<span class="ne">--&gt; </span><span class="mi">223</span> <span class="k">raise</span> <span class="n">MissingOptionalLibraryError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span>     <span class="n">libname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">pip_install</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_install</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span> <span class="p">)</span>

<span class="ne">MissingOptionalLibraryError</span>: &quot;The &#39;pylatexenc&#39; library is required to use &#39;MatplotlibDrawer&#39;. You can install it with &#39;pip install pylatexenc&#39;.&quot;
</pre></div>
</div>
</div>
</div>
<p>donde c (control) y t (target) son los qubits de control y de destino. <em>En los dispositivos IBM Q, sin embargo, el único tipo de puerta de dos qubits que puede aplicarse directamente es la CNOT</em>. Por tanto en ese sistema, necesitamos una forma de transformar una en otra.</p>
<p>El proceso es bastante sencillo. Sabemos que la puerta de  Hadamard transforma los estados <span class="math notranslate nohighlight">\(|0\rangle\)</span> y <span class="math notranslate nohighlight">\(|1\rangle\)</span> a los estados <span class="math notranslate nohighlight">\(|+\rangle\)</span> y <span class="math notranslate nohighlight">\(|-\rangle\)</span> respectivamente. También sabemos que el efecto de la puerta <span class="math notranslate nohighlight">\(Z\)</span> sobre los estados <span class="math notranslate nohighlight">\(|+\rangle\)</span> y <span class="math notranslate nohighlight">\(|-\rangle\)</span> es el mismo (en el sentido de que transforma un estado en otro) que el de <span class="math notranslate nohighlight">\(X\)</span> sobre los estados <span class="math notranslate nohighlight">\(|0\rangle\)</span> y <span class="math notranslate nohighlight">\(|1\rangle\)</span> respectivamente. De este razonamiento, o de la simple multiplicación de matrices, resulta que</p>
<div class="math notranslate nohighlight">
\[\begin{split}
H X H = Z,\\\\
H Z H = X.
\end{split}\]</div>
<p>NOTA: observar que lo anterior, se puede obtener de una forma muy fácil, sin más que tener en cuenta que <span class="math notranslate nohighlight">\(H^{-1}=H\)</span> entonces con esto, multiplicando los dos miembros de la igualdad anterior por <span class="math notranslate nohighlight">\(H=H^{-1}\)</span> se obtiene el resultado anterior.</p>
<p>El mismo truco se puede utilizar para transformar un CNOT en un <span class="math notranslate nohighlight">\(Z\)</span> controlado. Todo lo que tenemos que hacer es preceder y seguir el CNOT con un Hadamard en el qubit objetivo. Esto transformará cualquier <span class="math notranslate nohighlight">\(X\)</span> aplicado a ese qubit en un <span class="math notranslate nohighlight">\(Z\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># also a controlled-Z</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/12a252c532e0be2836716c1ada4e6c09be9f51e59eb4196c8ac5cc483910e2a9.png" src="../_images/12a252c532e0be2836716c1ada4e6c09be9f51e59eb4196c8ac5cc483910e2a9.png" />
</div>
</div>
<p>De forma más general, podemos transformar una CNOT simple en una versión controlada de cualquier rotación alrededor de la esfera de Bloch por un ángulo <span class="math notranslate nohighlight">\(\pi\)</span>, simplemente precediéndola y siguiéndola con las rotaciones correctas. Por ejemplo, <strong>un <span class="math notranslate nohighlight">\(Y\)</span> controlado</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># a controlled-Y</span>
<span class="n">qc</span><span class="o">.</span><span class="n">sdg</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ece799b8ddfe3f9f2f3bd80c96468862f578dc8efed5f4afadcf8875275a51b4.png" src="../_images/ece799b8ddfe3f9f2f3bd80c96468862f578dc8efed5f4afadcf8875275a51b4.png" />
</div>
</div>
<p>y un  <strong><span class="math notranslate nohighlight">\(H\)</span> controlado</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># a controlled-H</span>
<span class="n">qc</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c8e2bef570fe2f8a8ba95d43aad36261eb47b8a8f58954d4d2bbd821a64d1beb.png" src="../_images/c8e2bef570fe2f8a8ba95d43aad36261eb47b8a8f58954d4d2bbd821a64d1beb.png" />
</div>
</div>
</section>
<section id="intercambio-de-qubits-a-id-swapping-a">
<h2><span class="section-number">14.2. </span>Intercambio de Qubits <a id="swapping"></a><a class="headerlink" href="#intercambio-de-qubits-a-id-swapping-a" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Denominamos los qubits con estas letras</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p id="index-0">A veces necesitamos mover información en un ordenador cuántico. En algunas implementaciones de qubits, esto puede hacerse moviéndolos físicamente. Otra opción es simplemente mover el estado entre dos qubits. Esto se hace mediante la puerta SWAP.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># swaps states of qubits a and b</span>
<span class="n">qc</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7cbf1b74463dab7ef734891bafad282f4f75373538d7bf871fe24dd104393608.png" src="../_images/7cbf1b74463dab7ef734891bafad282f4f75373538d7bf871fe24dd104393608.png" />
</div>
</div>
<p>El comando anterior invoca directamente esta puerta, pero veamos <em>cómo podríamos hacerlo utilizando nuestro conjunto de puertas estándar</em>. Para ello, tendremos que considerar algunos ejemplos.</p>
<p>Primero veremos el caso de que el qubit a esté en el estado <span class="math notranslate nohighlight">\(|1\rangle\)</span> y el qubit b esté en el estado <span class="math notranslate nohighlight">\(|0\rangle\)</span>. Para ello aplicaremos las siguientes puertas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># swap a 1 from a to b</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="c1"># copies 1 from a to b</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="c1"># uses the 1 on b to rotate the state of a to 0</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0bd5cf97039bbc736154997ede5e94d93e621fc240bce60611e6ee6954b3dd1a.png" src="../_images/0bd5cf97039bbc736154997ede5e94d93e621fc240bce60611e6ee6954b3dd1a.png" />
</div>
</div>
<p>Según el esquema anterior, como el qubit a es uno la primera puerta CNOT transforma el qubit b a 1 (antes estaba en 0). Ahora la segunda puerta CNOT (X controlado), ve que el qubit de control (b en este caso) está a 1 y por lo tanto cambia el qubit target (a en este caso) del estado 1 al 0. Por lo tanto al final de todo este proceso, se ha pasado del estado <span class="math notranslate nohighlight">\(|01\rangle\)</span> al estado <span class="math notranslate nohighlight">\(|10\rangle\)</span>.</p>
<p>Esto tiene el efecto de poner el qubit b en el estado <span class="math notranslate nohighlight">\(|1\rangle\)</span> y el qubit a en el estado <span class="math notranslate nohighlight">\(|0\rangle\)</span>. Al menos en este caso, hemos hecho un SWAP.</p>
<p>Ahora vamos a tomar este estado y SWAP de nuevo a la original. Como habrás adivinado, podemos hacerlo con el proceso inverso al anterior:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># swap a q from b to a</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="c1"># copies 1 from b to a</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="c1"># uses the 1 on a to rotate the state of b to 0</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a7a2ce6d2f5265eb3918f654aa5a28a9051571233111419c763a222e15710970.png" src="../_images/a7a2ce6d2f5265eb3918f654aa5a28a9051571233111419c763a222e15710970.png" />
</div>
</div>
<p>Nótese que en estos dos procesos, la primera puerta de uno no tendría ningún efecto sobre el estado inicial del otro. Por ejemplo, cuando cambiamos el <span class="math notranslate nohighlight">\(|1\rangle\)</span> b por a, la primera puerta es <code class="docutils literal notranslate"><span class="pre">cx(b,a)</span></code>. Si esto se aplicara a un estado en el que no hubiera ningún <span class="math notranslate nohighlight">\(|1\rangle\)</span> inicialmente en b, no tendría ningún efecto.</p>
<p>Observe también que para estos dos procesos, la puerta final de uno no tendría ningún efecto sobre el estado final del otro. Por ejemplo, el <code class="docutils literal notranslate"><span class="pre">cx(b,a)</span></code> final que se requiere cuando cambiamos el <span class="math notranslate nohighlight">\(|1\rangle\)</span> de a a b no tiene ningún efecto sobre el estado donde el <span class="math notranslate nohighlight">\(|1\rangle\)</span> no está en b.</p>
<p>Con estas observaciones, podemos combinar los dos procesos añadiendo una puerta ineficaz de uno al otro. Por ejemplo,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/547d435c2cff6ae6cb2536aabc3d30f8149c9a58cc8c7a1820acbafe23ffaa0b.png" src="../_images/547d435c2cff6ae6cb2536aabc3d30f8149c9a58cc8c7a1820acbafe23ffaa0b.png" />
</div>
</div>
<p>Podemos pensar en esto como un proceso que intercambia un <span class="math notranslate nohighlight">\(|1\rangle\)</span> de a a b, pero con un inútil <code class="docutils literal notranslate"><span class="pre">qc.cx(b,a)</span></code> al principio (porque al principio como b esta en cero no haría ningún cambio el CNOT de la izquierda). También podemos pensar en ello como un proceso que intercambia un <span class="math notranslate nohighlight">\(|1\rangle\)</span> de b a a, pero con un inútil <code class="docutils literal notranslate"><span class="pre">qc.cx(b,a)</span></code> al final. De cualquier manera, el resultado es un proceso que puede hacer el intercambio en ambos sentidos.</p>
<p>También tiene el efecto correcto en el estado <span class="math notranslate nohighlight">\(|00\rangle\)</span>. Esto es simétrico, por lo que el intercambio de los estados no debería tener ningún efecto. Dado que las puertas CNOT no tienen efecto cuando sus qubits de control son <span class="math notranslate nohighlight">\(|0\rangle\)</span>, el proceso correctamente no hace nada.</p>
<p>El estado <span class="math notranslate nohighlight">\(|11\rangle\)</span> también es simétrico, por lo que necesita un efecto trivial del intercambio. En este caso, la primera puerta CNOT en el proceso anterior hará que la segunda no tenga efecto, y la tercera deshace la primera. Por lo tanto, todo el efecto es trivial.</p>
<p>Así, hemos encontrado una forma de descomponer las puertas SWAP en nuestro conjunto de puertas estándar de rotaciones de un solo qubit y puertas CNOT.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># swaps states of qubits a and b</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/547d435c2cff6ae6cb2536aabc3d30f8149c9a58cc8c7a1820acbafe23ffaa0b.png" src="../_images/547d435c2cff6ae6cb2536aabc3d30f8149c9a58cc8c7a1820acbafe23ffaa0b.png" />
</div>
</div>
<p>Funciona para los estados <span class="math notranslate nohighlight">\(|00\rangle\)</span>, <span class="math notranslate nohighlight">\(|01\rangle\)</span>, <span class="math notranslate nohighlight">\(|10\rangle\)</span> y <span class="math notranslate nohighlight">\(|11\rangle\)</span>, y si funciona para todos los estados de la base de cálculo, debe funcionar para todos los estados en general. Por lo tanto, este circuito intercambia todos los estados posibles de dos qubits.</p>
<p>El mismo efecto se produciría si cambiáramos el orden de las puertas CNOT:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># swaps states of qubits a and b</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5b5a27716e2f3e1795ea8df41a2222ef9201409dc343696b557bb0a115cadf6a.png" src="../_images/5b5a27716e2f3e1795ea8df41a2222ef9201409dc343696b557bb0a115cadf6a.png" />
</div>
</div>
<p>Por lo tanto este es un camino para obtener puertas del tipo  SWAP.</p>
<p>La derivación utilizada aquí se basó en gran medida en los estados de la base z, pero también podría hacerse pensando en lo que se necesita para intercambiar qubits en los estados <span class="math notranslate nohighlight">\(|+\rangle\)</span> y <span class="math notranslate nohighlight">\(|-\rangle\)</span>. Las formas resultantes de implementar la puerta SWAP serán completamente equivalentes a las de aquí.</p>
<section id="quick-ejercicios">
<h3><span class="section-number">14.2.1. </span>Quick Ejercicios:<a class="headerlink" href="#quick-ejercicios" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Encuentre un circuito diferente que intercambie qubits en los estados <span class="math notranslate nohighlight">\(|+\rangle\)</span> y <span class="math notranslate nohighlight">\(|-\rangle\)</span>, y demuestre que es equivalente al circuito mostrado anteriormente.</p></li>
</ul>
</section>
</section>
<section id="rotaciones-controladas-a-id-controlled-rotations-a">
<h2><span class="section-number">14.3. </span>Rotaciones controladas <a id="controlled-rotations"></a><a class="headerlink" href="#rotaciones-controladas-a-id-controlled-rotations-a" title="Permalink to this heading">#</a></h2>
<p>Ya hemos visto cómo construir rotaciones <span class="math notranslate nohighlight">\(\pi\)</span> controladas a partir de una sola puerta CNOT. Ahora veremos cómo construir cualquier rotación controlada.</p>
<p>En primer lugar, consideremos rotaciones arbitrarias alrededor del eje y. Específicamente, considere la siguiente secuencia de puertas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">pi</span> <span class="c1"># theta puede ser cualquier valor (pi se ha elegido arbitrariamente)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3f568923359fdfde5ecbeb0c726f61fd9b6359e5465f37fa8dceb6655bc75a0a.png" src="../_images/3f568923359fdfde5ecbeb0c726f61fd9b6359e5465f37fa8dceb6655bc75a0a.png" />
</div>
</div>
<p>Si el qubit de control está en estado <span class="math notranslate nohighlight">\(|0\rangle\)</span>, todo lo que tenemos aquí es un <span class="math notranslate nohighlight">\(R_y(\theta/2)\)</span> inmediatamente seguido de su inverso, <span class="math notranslate nohighlight">\(R_y(-\theta/2)\)</span>. El efecto final es trivial. Si el qubit de control está en el estado <span class="math notranslate nohighlight">\(|1\rangle\)</span>, sin embargo, el <code class="docutils literal notranslate"><span class="pre">ry(-theta/2)</span></code> es efectivamente precedido y seguido por una puerta X. Esto tiene el efecto de dar la vuelta al qubit. Esto tiene el efecto de invertir la dirección de la rotación  y hacer un segundo <span class="math notranslate nohighlight">\(R_y(\theta/2)\)</span>. El efecto neto en este caso <strong>es, por tanto, hacer una versión controlada de la rotación <span class="math notranslate nohighlight">\(R_y(\theta)\)</span></strong>.</p>
<p>Este método funciona porque los ejes x e y son ortogonales, lo que hace que las puertas x inviertan la dirección de la rotación. Por lo tanto, funciona de manera similar para hacer un controlado <span class="math notranslate nohighlight">\( R_z(\theta)\)</span>. Un <span class="math notranslate nohighlight">\(R_x(\theta)\)</span> controlado podría hacerse de manera similar utilizando puertas CNOT.</p>
<p>También podemos hacer una versión controlada de cualquier rotación de un solo qubit, <span class="math notranslate nohighlight">\(V\)</span>. Para ello sólo tenemos que encontrar tres rotaciones A, B y C, y una fase <span class="math notranslate nohighlight">\(\alpha\)</span> tal que</p>
<div class="math notranslate nohighlight">
\[
ABC = I, ~~~e^{i\alpha}AZBZC = V
\]</div>
<p>A continuación, utilizamos puertas Z controladas para hacer que la primera de estas relaciones ocurra siempre que el control esté en el estado <span class="math notranslate nohighlight">\(|0\rangle\)</span>, y que la segunda ocurra cuando el control esté en el estado <span class="math notranslate nohighlight">\(|1\rangle\)</span>. También se utiliza una rotación <span class="math notranslate nohighlight">\(R_z(2\alpha)\)</span> en el control para obtener la fase correcta, que será importante siempre que haya estados de superposición.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">Gate</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">Gate</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[])</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Gate</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[])</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># arbitrarily define alpha to allow drawing of circuit</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">[</span><span class="n">t</span><span class="p">])</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="p">[</span><span class="n">t</span><span class="p">])</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">[</span><span class="n">t</span><span class="p">])</span>
<span class="n">qc</span><span class="o">.</span><span class="n">p</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0917333222c7f5dddfde9c4f459769716e86c92b1a9d98f8021e3241ffb28ea8.png" src="../_images/0917333222c7f5dddfde9c4f459769716e86c92b1a9d98f8021e3241ffb28ea8.png" />
</div>
</div>
<p><img alt="A controlled version of a gate V" src="../_images/iden1.png" /></p>
<p>Aquí <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code> y <code class="docutils literal notranslate"><span class="pre">C</span></code> son puertas que implementan <span class="math notranslate nohighlight">\(A\)</span> , <span class="math notranslate nohighlight">\(B\)</span> y <span class="math notranslate nohighlight">\(C\)</span>, respectivamente​.</p>
</section>
<section id="la-puerta-de-toffoli-a-id-ccx-a">
<h2><span class="section-number">14.4. </span>La puerta de Toffoli <a id="ccx"></a><a class="headerlink" href="#la-puerta-de-toffoli-a-id-ccx-a" title="Permalink to this heading">#</a></h2>
<p id="index-1">La puerta de Toffoli es una puerta de tres qubits con <em>dos controles y un objetivo</em>. Realiza una X en el objetivo sólo si ambos controles están en el estado <span class="math notranslate nohighlight">\(|1\rangle\)</span>. El estado final del objetivo es entonces igual a la AND o la NAND de los dos controles, dependiendo de si el estado inicial del objetivo era <span class="math notranslate nohighlight">\(|0\rangle\)</span> o <span class="math notranslate nohighlight">\(|1\rangle\)</span>. Un Toffoli también se puede considerar como un controlado-controlado-NOT, y también se llama puerta CCX.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># Toffoli with control qubits a and b and target t</span>
<span class="n">qc</span><span class="o">.</span><span class="n">ccx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/12056b5891ef1811ad3fa782a42464b32303ddf2578f850e61ee0fd430107491.png" src="../_images/12056b5891ef1811ad3fa782a42464b32303ddf2578f850e61ee0fd430107491.png" />
</div>
</div>
<p>Para ver cómo construirlo a partir de puertas de uno y dos qubits, es útil mostrar primero cómo construir algo aún más general: una U arbitraria controlada-controlada para cualquier rotación de un solo qubit U. Para ello necesitamos definir versiones controladas de <span class="math notranslate nohighlight">\(V = \sqrt{U}\)</span> y <span class="math notranslate nohighlight">\(V^\dagger\)</span>. En el código de abajo, usamos <code class="docutils literal notranslate"><span class="pre">cp(theta,c,t)</span></code> y <code class="docutils literal notranslate"><span class="pre">cp(-theta,c,t)</span></code> en lugar de las subrutinas indefinidas <code class="docutils literal notranslate"><span class="pre">cv</span></code> y <code class="docutils literal notranslate"><span class="pre">cvdg</span></code> respectivamente. Los controles son los qubits <span class="math notranslate nohighlight">\(a\)</span> y <span class="math notranslate nohighlight">\(b\)</span>, y el objetivo es el qubit <span class="math notranslate nohighlight">\(t\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/536f80d015a78dad945473a92034af95551469625c2886252265e1755603a920.png" src="../_images/536f80d015a78dad945473a92034af95551469625c2886252265e1755603a920.png" />
</div>
</div>
<p><img alt="A doubly controlled version of a gate V" src="../_images/iden2.PNG" /></p>
<p>Rastreando cada valor de los dos qubits de control, puedes convencerte de que se aplica una puerta U al qubit objetivo si y sólo si ambos controles son 1. Utilizando las ideas que ya hemos descrito, ahora podrías implementar cada puerta V controlada para llegar a algún circuito para la puerta U doblemente controlada. Resulta que el número mínimo de puertas CNOT necesarias para implementar la puerta Toffoli es seis .</p>
<p><img alt="A Toffoli" src="../_images/iden3.PNG" /></p>
<p>Se trata de una puerta de Toffoli con 3 qubits(q0,q1,q2) respectivamente. En este ejemplo de circuito, q0 está conectado con q2 pero q0 no está conectado con q1</p>
<p>La puerta de Toffoli no es la única forma de implementar una puerta AND en la informática cuántica. También podríamos definir otras puertas que tengan el mismo efecto, pero que además introduzcan fases relativas. En estos casos, podemos implementar la puerta con menos CNOTs.</p>
<p>Por ejemplo, supongamos que utilizamos las puertas controlada-Hadamard y controlada-<span class="math notranslate nohighlight">\(Z\)</span>, que pueden implementarse con una sola CNOT. Con ellas podemos hacer el siguiente circuito:</p>
<p>For example, suppose we use both the controlled-Hadamard and controlled-<span class="math notranslate nohighlight">\(Z\)</span> gates, which can both be implemented with a single CNOT. With these we can make the following circuit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">ch</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">ch</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/95df2360ab7a3220355d169482b81c9ceffb5498b537a98d714460d202aac9f9.png" src="../_images/95df2360ab7a3220355d169482b81c9ceffb5498b537a98d714460d202aac9f9.png" />
</div>
</div>
<p>Para el estado <span class="math notranslate nohighlight">\(|00\rangle\)</span> en los dos controles, esto no hace nada al objetivo. Para <span class="math notranslate nohighlight">\(|11\rangle\)</span>, el objetivo experimenta una puerta <span class="math notranslate nohighlight">\(Z\)</span> precedida y seguida por una H. El efecto neto es una <span class="math notranslate nohighlight">\(X\)</span> en el objetivo. Para los estados <span class="math notranslate nohighlight">\(|01\rangle\)</span> y <span class="math notranslate nohighlight">\(|10\rangle\)</span>, el objetivo experimenta sólo los dos Hadamards \ (que se anulan mutuamente) o sólo el <span class="math notranslate nohighlight">\(Z\)</span> \ (que sólo induce una fase relativa). Por lo tanto, esto también reproduce el efecto de una AND, porque el valor del objetivo sólo se cambia para el estado <span class="math notranslate nohighlight">\(|11\rangle\)</span> en los controles – pero lo hace con el equivalente de sólo tres puertas CNOT.</p>
</section>
<section id="rotacion-arbitraria-de-h-y-t-a-id-arbitrary-rotations-a">
<h2><span class="section-number">14.5. </span>Rotación arbitraria de H y T. <a id="arbitrary-rotations"></a><a class="headerlink" href="#rotacion-arbitraria-de-h-y-t-a-id-arbitrary-rotations-a" title="Permalink to this heading">#</a></h2>
<p>Los qubits de los dispositivos actuales están sujetos a ruido, que consiste básicamente en puertas que se abren por error. Cosas tan simples como la temperatura, los campos magnéticos parásitos o la actividad en qubits vecinos pueden hacer que ocurran cosas que no pretendíamos.</p>
<p>Para las grandes aplicaciones de los ordenadores cuánticos, será necesario codificar nuestros qubits de forma que queden protegidos de este ruido. Esto se consigue haciendo que las puertas sean mucho más difíciles de hacer por error, o de implementar de forma ligeramente errónea.</p>
<p>Esto es desafortunado para las rotaciones de un solo qubit <span class="math notranslate nohighlight">\(R_x(\theta)\)</span>, <span class="math notranslate nohighlight">\(R_y(\theta)\)</span> y <span class="math notranslate nohighlight">\(R_z(\theta)\)</span>. Es imposible implementar un ángulo <span class="math notranslate nohighlight">\(\theta\)</span> con una precisión perfecta, de tal manera que estés seguro de que no estás implementando accidentalmente algo como <span class="math notranslate nohighlight">\(\theta + 0.0000001\)</span>. Siempre habrá un límite a la precisión que podemos alcanzar, y siempre será mayor de lo tolerable cuando tengamos en cuenta la acumulación de imperfecciones en circuitos grandes. Por lo tanto, <strong>no podremos implementar estas rotaciones directamente en ordenadores cuánticos tolerantes a fallos</strong>, sino que tendremos que construirlas de una manera mucho más deliberada.</p>
<p>Los esquemas tolerantes a fallos suelen realizar estas rotaciones utilizando múltiples aplicaciones de sólo dos puertas: <span class="math notranslate nohighlight">\(H\)</span> y <span class="math notranslate nohighlight">\(T\)</span>.</p>
<p>La puerta T se expresa en Qiskit como <code class="docutils literal notranslate"><span class="pre">.t()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Puerta T sobre el qubit 0</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fe49971d4dc7909f328fb1b28dcb4858307ea4bc52e8c9c13241d7eb2debdd67.png" src="../_images/fe49971d4dc7909f328fb1b28dcb4858307ea4bc52e8c9c13241d7eb2debdd67.png" />
</div>
</div>
<p>Es una rotación alrededor del eje z por <span class="math notranslate nohighlight">\(\theta = \pi/4\)</span>, y así se expresa matemáticamente como <span class="math notranslate nohighlight">\(R_z(\pi/4) = e^{i\pi/8~Z}\)</span>.</p>
<p>A continuación supondremos que las puertas <span class="math notranslate nohighlight">\(H\)</span> y <span class="math notranslate nohighlight">\(T\)</span> son efectivamente perfectas. Esto puede lograrse mediante métodos adecuados de corrección de errores y tolerancia a fallos.</p>
<p>Utilizando la puerta Hadamard y los métodos discutidos en el último capítulo, podemos utilizar la puerta T para crear una rotación similar alrededor del eje x.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9d222e414ceb45795be3e3f2d34aad2278e02ea5ba237c1e0f7003ffb8d4199c.png" src="../_images/9d222e414ceb45795be3e3f2d34aad2278e02ea5ba237c1e0f7003ffb8d4199c.png" />
</div>
</div>
<p>Ahora unamos las dos cosas. Hagamos la puerta <span class="math notranslate nohighlight">\(R_z(\pi/4)~R_x(\pi/4)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05d124a9e71f6427d6baffe9fd49ab8ff3267022068698649a3ee4da3cf46b93.png" src="../_images/05d124a9e71f6427d6baffe9fd49ab8ff3267022068698649a3ee4da3cf46b93.png" />
</div>
</div>
<p>Dado que se trata de una puerta de un solo qubit, podemos pensar en ella como una rotación alrededor de la esfera de Bloch. Eso significa que es una rotación alrededor de algún eje por algún ángulo. No necesitamos pensar demasiado en el eje aquí, pero está claro que no será simplemente x, y o z. Más importante es el ángulo.</p>
<p>La propiedad crucial del ángulo para esta rotación es que es un múltiplo irracional de <span class="math notranslate nohighlight">\(\pi\)</span>. Puedes demostrarlo tú mismo con un montón de matemáticas, pero también puedes ver la irracionalidad en acción aplicando la puerta. Teniendo en cuenta que cada vez que aplicamos una rotación mayor que <span class="math notranslate nohighlight">\(2\pi\)</span>, estamos haciendo un módulo implícito por <span class="math notranslate nohighlight">\(2\pi\)</span> sobre el ángulo de rotación. Así, repitiendo la rotación combinada antes mencionada <span class="math notranslate nohighlight">\(n\)</span> veces se obtiene una rotación alrededor del mismo eje por un ángulo diferente.</p>
<p>Podemos usar esto a nuestro favor. Cada ángulo estará en algún lugar entre <span class="math notranslate nohighlight">\(0\)</span> y <span class="math notranslate nohighlight">\(2\pi\)</span>. Dividamos este intervalo en <span class="math notranslate nohighlight">\(n\)</span> trozos de anchura <span class="math notranslate nohighlight">\(2\pi/n\)</span>. Para cada repetición, el ángulo resultante caerá en una de estas rebanadas. Si nos fijamos en los ángulos de las primeras <span class="math notranslate nohighlight">\(n+1\)</span> repeticiones, debe ser cierto que al menos una rebanada contiene dos de estos ángulos debido al principio de encasillamiento. Utilicemos <span class="math notranslate nohighlight">\(n_1\)</span> para denotar el número de repeticiones necesarias para la primera, y <span class="math notranslate nohighlight">\(n_2\)</span> para la segunda.</p>
<p>Con esto, podemos demostrar algo sobre el ángulo para <span class="math notranslate nohighlight">\(n_2-n_1\)</span> repeticiones. Esto es efectivamente lo mismo que hacer <span class="math notranslate nohighlight">\(n_2\)</span> repeticiones, seguido de la inversa de <span class="math notranslate nohighlight">\(n_1\)</span> repeticiones. Dado que los ángulos para estos no son iguales (debido a la irracionalidad), pero también difieren en no más de <span class="math notranslate nohighlight">\(2\pi/n\)</span> (porque corresponden a la misma rebanada), el ángulo para <span class="math notranslate nohighlight">\(n_2-n_1\)</span> repeticiones satisface</p>
<div class="math notranslate nohighlight">
\[
\theta_{n_2-n_1} \neq 0, ~~~~-\frac{2\pi}{n} \leq \theta_{n_2-n_1} \leq \frac{2\pi}{n} .
\]</div>
<p>Por lo tanto, tenemos la capacidad de hacer rotaciones alrededor de ángulos pequeños. Podemos usar esto para rotar alrededor de ángulos tan pequeños como queramos, simplemente aumentando el número de veces que repetimos esta puerta.</p>
<p>Mediante el uso de muchas rotaciones de ángulo pequeño, también podemos rotar por cualquier ángulo que nos gusta. Esto no siempre será exacta, pero se garantiza que sea exacta hasta <span class="math notranslate nohighlight">\(2\pi/n\)</span>, que se puede hacer tan pequeño como nos gusta. Ahora tenemos poder sobre las imprecisiones en nuestras rotaciones.</p>
<p>Hasta ahora, sólo tenemos el poder de hacer estas rotaciones arbitrarias alrededor de un eje. Para un segundo eje, simplemente hacemos las rotaciones <span class="math notranslate nohighlight">\(R_z(\pi/4)\)</span> y <span class="math notranslate nohighlight">\(R_x(\pi/4)\)</span> en el orden inverso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7faa50968628eb54c854e7f10a67cc9090b9f99e19fd28db96df751c1382cbcb.png" src="../_images/7faa50968628eb54c854e7f10a67cc9090b9f99e19fd28db96df751c1382cbcb.png" />
</div>
</div>
<p>El eje que corresponde a esta rotación no es el mismo que el de la puerta considerada anteriormente. Por lo tanto, ahora tenemos una rotación arbitraria alrededor de dos ejes, que puede utilizarse para generar cualquier rotación arbitraria alrededor de la esfera de Bloch. Volvemos a poder hacerlo todo, aunque cuesta bastantes <span class="math notranslate nohighlight">\(T\)</span> compuertas.</p>
<p>POr esto y para este tipo de aplicaciones, las puertas <span class="math notranslate nohighlight">\(T\)</span> son tan importantes en la computación cuántica. De hecho, la complejidad de los algoritmos de los ordenadores cuánticos con tolerancia a fallos se suele expresar en términos de cuántas puertas <span class="math notranslate nohighlight">\(T\)</span> se necesitan. Esto motiva la búsqueda de logros con el menor número posible de puertas <span class="math notranslate nohighlight">\(T\)</span>. Nótese que la discusión anterior sólo pretendía demostrar que las puertas <span class="math notranslate nohighlight">\(T\)</span> pueden utilizarse de este modo, y no representa el método más eficiente que conocemos.</p>
</section>
<section id="referencias-a-id-references-a">
<h2><span class="section-number">14.6. </span>Referencias <a id="references"></a><a class="headerlink" href="#referencias-a-id-references-a" title="Permalink to this heading">#</a></h2>
<p>[1] <a class="reference external" href="https://journals.aps.org/pra/abstract/10.1103/PhysRevA.52.3457?cm_mc_uid=43781767191014577577895&amp;cm_mc_sid_50200000=1460741020">Barenco, <em>et al.</em> 1995</a></p>
<p>[2] <a class="reference external" href="http://dl.acm.org/citation.cfm?id=2011799">Shende and Markov, 2009</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">qiskit.tools.jupyter</span>
<span class="o">%</span><span class="k">qiskit_version_table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><h3>Version Information</h3><table><tr><th>Software</th><th>Version</th></tr><tr><td><code>qiskit</code></td><td>0.44.2</td></tr><tr><td><code>qiskit-terra</code></td><td>0.25.2</td></tr><tr><th colspan='2'>System information</th></tr><tr><td>Python version</td><td>3.11.4</td></tr><tr><td>Python compiler</td><td>MSC v.1916 64 bit (AMD64)</td></tr><tr><td>Python build</td><td>main, Jul  5 2023 13:38:37</td></tr><tr><td>OS</td><td>Windows</td></tr><tr><td>CPUs</td><td>4</td></tr><tr><td>Memory (Gb)</td><td>11.799663543701172</td></tr><tr><td colspan='2'>Tue Oct 24 10:15:32 2023 Hora de verano romance</td></tr></table></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./jupyters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Tema5_phase-kickback.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">12. </span>Explorando la puerta CNOT-Gate <a id="exploring-cnot"></a></p>
      </div>
    </a>
    <a class="right-next"
       href="Tema7_proving-universality.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">15. </span>Proving Universality <a id='intro'></a></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construyendo-una-z-controlada-desde-un-cnot-a-id-c-from-cnot-a">14.1. Construyendo una Z controlada desde un CNOT. <a id="c-from-cnot"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intercambio-de-qubits-a-id-swapping-a">14.2. Intercambio de Qubits <a id="swapping"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-ejercicios">14.2.1. Quick Ejercicios:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotaciones-controladas-a-id-controlled-rotations-a">14.3. Rotaciones controladas <a id="controlled-rotations"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#la-puerta-de-toffoli-a-id-ccx-a">14.4. La puerta de Toffoli <a id="ccx"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotacion-arbitraria-de-h-y-t-a-id-arbitrary-rotations-a">14.5. Rotación arbitraria de H y T. <a id="arbitrary-rotations"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#referencias-a-id-references-a">14.6. Referencias <a id="references"></a></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Francisco Rodríguez
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>